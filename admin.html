<html lang="pt-BR" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Admin Profissional - FideProta</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: "Poppins", sans-serif;
    }
    .hidden {
      display: none;
    }
    textarea {
      resize: vertical;
    }
    .input-error {
      border-color: #f87171 !important;
    }
  </style>
</head>
<body class="bg-black text-purple-300 min-h-screen flex flex-col">
  <header
    class="bg-gradient-to-r from-purple-900 via-purple-800 to-purple-700 shadow-lg"
  >
    <div
      class="container mx-auto px-6 py-6 flex items-center justify-between flex-wrap gap-4"
    >
      <h1 class="text-3xl font-semibold select-none">Painel Admin - FideProta</h1>
      <button
        id="logoutBtn"
        class="bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-4 py-2 font-semibold text-white hidden"
        title="Sair do painel"
      >
        Sair
      </button>
    </div>
  </header>
  <main class="flex-grow container mx-auto px-6 py-12 max-w-7xl">
    <!-- Login Section -->
    <section
      id="loginSection"
      class="max-w-md mx-auto bg-gray-900 rounded-3xl shadow-lg p-10 flex flex-col items-center space-y-6"
    >
      <i class="fas fa-user-shield fa-6x text-purple-500"></i>
      <h2 class="text-3xl font-extrabold text-purple-400">Login do Administrador</h2>
      <input
        aria-label="Campo para senha do administrador"
        class="w-full rounded-lg px-4 py-3 text-black font-semibold text-lg"
        id="passwordInput"
        placeholder="Digite a senha"
        type="password"
        autocomplete="current-password"
      />
      <button
        class="w-full bg-purple-600 hover:bg-purple-700 transition-colors rounded-full py-3 font-semibold text-white text-lg"
        id="loginBtn"
        type="button"
      >
        Entrar
      </button>
      <p class="text-red-500 font-semibold hidden" id="errorMsg">
        Senha incorreta. Tente novamente.
      </p>
    </section>

    <!-- Admin Panel Section -->
    <section id="adminPanel" class="hidden space-y-12">
      <h2 class="text-4xl font-extrabold text-center text-purple-400 mb-8">
        Painel de Controle Profissional - Personalize seu Site
      </h2>

      <!-- Site General Settings -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Configurações Gerais do Site</h3>
        <form id="generalSettingsForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto" novalidate>
          <div>
            <label for="siteTitle" class="block mb-2 font-semibold">Título do Site</label>
            <input
              type="text"
              id="siteTitle"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              placeholder="FideProta"
              required
            />
          </div>
          <div>
            <label for="siteDescription" class="block mb-2 font-semibold">Descrição do Site</label>
            <textarea
              id="siteDescription"
              rows="3"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              placeholder="Melhore o desempenho do seu PC e personalize sua tela com papéis de parede incríveis."
              required
            ></textarea>
          </div>
          <div>
            <label for="instagramHandle" class="block mb-2 font-semibold">Instagram do Criador</label>
            <input
              type="text"
              id="instagramHandle"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              placeholder="fideprotaofc"
              required
            />
          </div>
          <div>
            <label for="logoUrl" class="block mb-2 font-semibold">URL do Logo (60x60)</label>
            <input
              type="url"
              id="logoUrl"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              placeholder="https://example.com/logo.png"
              required
            />
          </div>
          <div>
            <label for="footerLogoUrl" class="block mb-2 font-semibold">URL do Logo Pequeno do Footer (50x50)</label>
            <input
              type="url"
              id="footerLogoUrl"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              placeholder="https://example.com/footer-logo.png"
              required
            />
          </div>
        </form>
        <button
          id="applyGeneralSettingsBtn"
          type="button"
          class="mt-6 bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-6 py-3 font-semibold text-white w-full md:w-auto"
          title="Salvar configurações gerais"
        >
          Aplicar Configurações Gerais
        </button>
      </div>

      <!-- Colors -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Configuração de Cores</h3>
        <form id="colorsForm" class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto" novalidate>
          <div>
            <label for="colorPrimary" class="block mb-2 font-semibold">Cor Primária (ex: botão, header)</label>
            <input
              type="color"
              id="colorPrimary"
              class="w-full h-10 rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold cursor-pointer"
              value="#7c3aed"
              title="Cor primária"
            />
          </div>
          <div>
            <label for="colorSecondary" class="block mb-2 font-semibold">Cor Secundária (ex: botões secundários)</label>
            <input
              type="color"
              id="colorSecondary"
              class="w-full h-10 rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold cursor-pointer"
              value="#a78bfa"
              title="Cor secundária"
            />
          </div>
          <div>
            <label for="colorBackground" class="block mb-2 font-semibold">Cor de Fundo Principal</label>
            <input
              type="color"
              id="colorBackground"
              class="w-full h-10 rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold cursor-pointer"
              value="#000000"
              title="Cor de fundo"
            />
          </div>
        </form>
        <button
          id="applyColorsBtn"
          type="button"
          class="mt-6 bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-6 py-3 font-semibold text-white w-full md:w-auto"
          title="Salvar cores"
        >
          Aplicar Cores
        </button>
      </div>

      <!-- Buttons -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Configuração dos Botões</h3>
        <form id="buttonsForm" class="space-y-6 max-w-4xl mx-auto" novalidate>
          <div>
            <label for="btnPrimaryText" class="block mb-2 font-semibold">Texto do Botão Primário</label>
            <input
              type="text"
              id="btnPrimaryText"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="Otimização PC"
              required
            />
          </div>
          <div>
            <label for="btnPrimaryLink" class="block mb-2 font-semibold">Link do Botão Primário</label>
            <input
              type="url"
              id="btnPrimaryLink"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="optimization.html"
              required
            />
          </div>
          <div>
            <label for="btnSecondaryText" class="block mb-2 font-semibold">Texto do Botão Secundário</label>
            <input
              type="text"
              id="btnSecondaryText"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="Papéis de Parede"
              required
            />
          </div>
          <div>
            <label for="btnSecondaryLink" class="block mb-2 font-semibold">Link do Botão Secundário</label>
            <input
              type="url"
              id="btnSecondaryLink"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="wallpapers.html"
              required
            />
          </div>
        </form>
        <button
          id="applyButtonsBtn"
          type="button"
          class="mt-6 bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-6 py-3 font-semibold text-white w-full md:w-auto"
          title="Salvar configurações dos botões"
        >
          Aplicar Botões
        </button>
      </div>

      <!-- Categories -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Gerenciar Categorias do Site</h3>
        <form id="categoriesForm" class="space-y-4 max-w-4xl mx-auto" novalidate>
          <div
            id="categoriesList"
            class="space-y-3 max-h-64 overflow-y-auto border border-purple-700 rounded-lg p-4 bg-black"
            aria-live="polite"
            aria-relevant="additions removals"
          >
            <!-- Categorias serão inseridas aqui -->
          </div>
          <div class="flex space-x-4">
            <input
              aria-label="Novo nome da categoria"
              class="flex-grow rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              id="newCategoryInput"
              placeholder="Nova categoria"
              type="text"
              autocomplete="off"
            />
            <button
              class="bg-indigo-600 hover:bg-indigo-700 transition-colors rounded-full px-6 py-2 font-semibold text-white"
              id="addCategoryBtn"
              type="button"
              title="Adicionar nova categoria"
            >
              Adicionar
            </button>
          </div>
        </form>
      </div>

      <!-- Design -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Configurações de Design</h3>
        <form id="designForm" class="space-y-6 max-w-4xl mx-auto" novalidate>
          <div>
            <label for="fontSelect" class="block mb-2 font-semibold">Fonte do Site</label>
            <select
              id="fontSelect"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              title="Selecione a fonte do site"
            >
              <option value="'Poppins', sans-serif" selected>Poppins (Padrão)</option>
              <option value="'Roboto', sans-serif">Roboto</option>
              <option value="'Open Sans', sans-serif">Open Sans</option>
              <option value="'Lato', sans-serif">Lato</option>
              <option value="'Montserrat', sans-serif">Montserrat</option>
            </select>
          </div>
          <div>
            <label for="borderRadius" class="block mb-2 font-semibold">Raio das Bordas (px)</label>
            <input
              type="number"
              id="borderRadius"
              max="50"
              min="0"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="24"
              title="Raio das bordas para elementos arredondados"
            />
          </div>
          <div>
            <label for="shadowIntensity" class="block mb-2 font-semibold">Intensidade da Sombra (0 a 100)</label>
            <input
              type="number"
              id="shadowIntensity"
              max="100"
              min="0"
              class="w-full rounded-lg border border-purple-700 bg-black px-3 py-2 text-purple-300 font-semibold focus:outline-none focus:ring-2 focus:ring-purple-500"
              value="50"
              title="Intensidade da sombra para elementos com sombra"
            />
          </div>
        </form>
        <button
          id="applyDesignBtn"
          type="button"
          class="mt-6 bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-6 py-3 font-semibold text-white w-full md:w-auto"
          title="Salvar configurações de design"
        >
          Aplicar Design
        </button>
      </div>

      <!-- Custom CSS -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">CSS Personalizado</h3>
        <textarea
          id="customCss"
          rows="8"
          placeholder="Adicione seu CSS personalizado aqui..."
          class="w-full rounded-lg border border-purple-700 bg-black px-4 py-3 text-purple-300 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"
          aria-label="Área para CSS personalizado"
        ></textarea>
        <button
          id="applyCustomCssBtn"
          type="button"
          class="mt-6 bg-purple-600 hover:bg-purple-700 transition-colors rounded-full px-6 py-3 font-semibold text-white w-full md:w-auto"
          title="Aplicar CSS personalizado"
        >
          Aplicar CSS Personalizado
        </button>
      </div>

      <!-- Export / Import Settings -->
      <div class="bg-gray-900 rounded-3xl shadow-lg p-8">
        <h3 class="text-2xl font-bold mb-6 text-purple-400">Exportar / Importar Configurações</h3>
        <div class="flex flex-col md:flex-row md:space-x-6 space-y-4 md:space-y-0 max-w-4xl mx-auto">
          <button
            id="exportSettingsBtn"
            class="flex-1 bg-indigo-600 hover:bg-indigo-700 transition-colors rounded-full px-6 py-3 font-semibold text-white flex items-center justify-center space-x-3"
            type="button"
            title="Exportar configurações para arquivo JSON"
          >
            <i class="fas fa-file-export"></i>
            <span>Exportar Configurações</span>
          </button>
          <label
            for="importSettingsInput"
            class="flex-1 cursor-pointer bg-green-600 hover:bg-green-700 transition-colors rounded-full px-6 py-3 font-semibold text-white flex items-center justify-center space-x-3"
            title="Importar configurações de arquivo JSON"
          >
            <i class="fas fa-file-import"></i>
            <span>Importar Configurações</span>
            <input
              type="file"
              id="importSettingsInput"
              accept="application/json"
              class="hidden"
              aria-label="Importar configurações do arquivo JSON"
            />
          </label>
        </div>
      </div>
    </section>
  </main>
  <footer
    class="bg-gradient-to-r from-purple-900 via-purple-800 to-purple-700 text-purple-300 py-8 mt-16 text-center select-none"
  >
    © 2024 FideProta - Painel Admin
  </footer>

  <script>
    (() => {
      const PASSWORD = "2990298739@";
      const loginSection = document.getElementById("loginSection");
      const adminPanel = document.getElementById("adminPanel");
      const loginBtn = document.getElementById("loginBtn");
      const passwordInput = document.getElementById("passwordInput");
      const errorMsg = document.getElementById("errorMsg");
      const logoutBtn = document.getElementById("logoutBtn");

      // General Settings Elements
      const siteTitleInput = document.getElementById("siteTitle");
      const siteDescriptionInput = document.getElementById("siteDescription");
      const instagramHandleInput = document.getElementById("instagramHandle");
      const logoUrlInput = document.getElementById("logoUrl");
      const footerLogoUrlInput = document.getElementById("footerLogoUrl");
      const applyGeneralSettingsBtn = document.getElementById("applyGeneralSettingsBtn");

      // Colors Elements
      const colorPrimaryInput = document.getElementById("colorPrimary");
      const colorSecondaryInput = document.getElementById("colorSecondary");
      const colorBackgroundInput = document.getElementById("colorBackground");
      const applyColorsBtn = document.getElementById("applyColorsBtn");

      // Buttons Elements
      const btnPrimaryText = document.getElementById("btnPrimaryText");
      const btnPrimaryLink = document.getElementById("btnPrimaryLink");
      const btnSecondaryText = document.getElementById("btnSecondaryText");
      const btnSecondaryLink = document.getElementById("btnSecondaryLink");
      const applyButtonsBtn = document.getElementById("applyButtonsBtn");

      // Categories Elements
      const categoriesList = document.getElementById("categoriesList");
      const newCategoryInput = document.getElementById("newCategoryInput");
      const addCategoryBtn = document.getElementById("addCategoryBtn");

      // Design Elements
      const fontSelect = document.getElementById("fontSelect");
      const borderRadiusInput = document.getElementById("borderRadius");
      const shadowIntensityInput = document.getElementById("shadowIntensity");
      const applyDesignBtn = document.getElementById("applyDesignBtn");

      // Custom CSS
      const customCssTextarea = document.getElementById("customCss");
      const applyCustomCssBtn = document.getElementById("applyCustomCssBtn");

      // Export / Import
      const exportSettingsBtn = document.getElementById("exportSettingsBtn");
      const importSettingsInput = document.getElementById("importSettingsInput");

      // Storage keys
      const STORAGE_KEYS = {
        loggedIn: "fideprota_admin_loggedIn",
        general: "fideprota_admin_general",
        colors: "fideprota_admin_colors",
        buttons: "fideprota_admin_buttons",
        categories: "fideprota_admin_categories",
        design: "fideprota_admin_design",
        customCss: "fideprota_admin_customCss",
      };

      // Utility: Validate URL format (simple)
      function isValidUrl(string) {
        try {
          new URL(string);
          return true;
        } catch (_) {
          return false;
        }
      }

      // Validate form inputs with visual feedback
      function validateInputs(inputs) {
        let valid = true;
        inputs.forEach((input) => {
          input.classList.remove("input-error");
          if (!input.value.trim()) {
            input.classList.add("input-error");
            valid = false;
          } else if (
            (input.type === "url" || input.id.includes("Url")) &&
            !isValidUrl(input.value.trim())
          ) {
            input.classList.add("input-error");
            valid = false;
          }
        });
        return valid;
      }

      // Check login state on load
      function checkLogin() {
        if (localStorage.getItem(STORAGE_KEYS.loggedIn) === "true") {
          loginSection.classList.add("hidden");
          adminPanel.classList.remove("hidden");
          logoutBtn.classList.remove("hidden");
          loadSettings();
        } else {
          loginSection.classList.remove("hidden");
          adminPanel.classList.add("hidden");
          logoutBtn.classList.add("hidden");
        }
      }

      // Login handler
      loginBtn.addEventListener("click", () => {
        const val = passwordInput.value.trim();
        if (val === PASSWORD) {
          localStorage.setItem(STORAGE_KEYS.loggedIn, "true");
          errorMsg.classList.add("hidden");
          passwordInput.value = "";
          checkLogin();
        } else {
          errorMsg.classList.remove("hidden");
        }
      });

      // Logout handler
      logoutBtn.addEventListener("click", () => {
        localStorage.removeItem(STORAGE_KEYS.loggedIn);
        checkLogin();
      });

      // Apply General Settings
      applyGeneralSettingsBtn.addEventListener("click", () => {
        const inputs = [
          siteTitleInput,
          siteDescriptionInput,
          instagramHandleInput,
          logoUrlInput,
          footerLogoUrlInput,
        ];
        if (!validateInputs(inputs)) {
          alert("Por favor, preencha todos os campos corretamente.");
          return;
        }
        const general = {
          siteTitle: siteTitleInput.value.trim(),
          siteDescription: siteDescriptionInput.value.trim(),
          instagramHandle: instagramHandleInput.value.trim(),
          logoUrl: logoUrlInput.value.trim(),
          footerLogoUrl: footerLogoUrlInput.value.trim(),
        };
        localStorage.setItem(STORAGE_KEYS.general, JSON.stringify(general));
        alert("Configurações gerais aplicadas e salvas!");
      });

      // Apply colors
      applyColorsBtn.addEventListener("click", () => {
        const colors = {
          primary: colorPrimaryInput.value,
          secondary: colorSecondaryInput.value,
          background: colorBackgroundInput.value,
        };
        localStorage.setItem(STORAGE_KEYS.colors, JSON.stringify(colors));
        applyColors(colors);
        alert("Cores aplicadas e salvas!");
      });

      // Apply buttons
      applyButtonsBtn.addEventListener("click", () => {
        const inputs = [btnPrimaryText, btnPrimaryLink, btnSecondaryText, btnSecondaryLink];
        if (!validateInputs(inputs)) {
          alert("Por favor, preencha todos os campos dos botões corretamente.");
          return;
        }
        const buttons = {
          primaryText: btnPrimaryText.value.trim(),
          primaryLink: btnPrimaryLink.value.trim(),
          secondaryText: btnSecondaryText.value.trim(),
          secondaryLink: btnSecondaryLink.value.trim(),
        };
        localStorage.setItem(STORAGE_KEYS.buttons, JSON.stringify(buttons));
        alert("Configurações dos botões salvas!");
      });

      // Categories management
      function renderCategories() {
        categoriesList.innerHTML = "";
        const categories =
          JSON.parse(localStorage.getItem(STORAGE_KEYS.categories)) || [
            "Otimização PC",
            "Papéis de Parede",
            "Contato",
          ];
        categories.forEach((cat, idx) => {
          const div = document.createElement("div");
          div.className =
            "flex items-center justify-between bg-purple-900 rounded-lg px-4 py-2";
          const span = document.createElement("span");
          span.textContent = cat;
          span.className = "font-semibold text-purple-300 truncate max-w-[80%]";
          const btn = document.createElement("button");
          btn.className = "text-red-500 hover:text-red-600 font-bold";
          btn.textContent = "Remover";
          btn.title = `Remover categoria "${cat}"`;
          btn.addEventListener("click", () => {
            if (
              confirm(
                `Tem certeza que deseja remover a categoria "${cat}"? Esta ação não pode ser desfeita.`
              )
            ) {
              categories.splice(idx, 1);
              localStorage.setItem(STORAGE_KEYS.categories, JSON.stringify(categories));
              renderCategories();
            }
          });
          div.appendChild(span);
          div.appendChild(btn);
          categoriesList.appendChild(div);
        });
      }

      addCategoryBtn.addEventListener("click", () => {
        const newCat = newCategoryInput.value.trim();
        if (!newCat) {
          alert("Digite o nome da nova categoria.");
          return;
        }
        let categories =
          JSON.parse(localStorage.getItem(STORAGE_KEYS.categories)) || [
            "Otimização PC",
            "Papéis de Parede",
            "Contato",
          ];
        if (categories.includes(newCat)) {
          alert("Categoria já existe.");
          return;
        }
        categories.push(newCat);
        localStorage.setItem(STORAGE_KEYS.categories, JSON.stringify(categories));
        newCategoryInput.value = "";
        renderCategories();
        alert("Categoria adicionada!");
      });

      // Apply design
      applyDesignBtn.addEventListener("click", () => {
        const borderRadiusVal = borderRadiusInput.value;
        const shadowIntensityVal = shadowIntensityInput.value;
        if (
          borderRadiusVal === "" ||
          isNaN(borderRadiusVal) ||
          borderRadiusVal < 0 ||
          borderRadiusVal > 50
        ) {
          alert("Raio das bordas deve ser um número entre 0 e 50.");
          borderRadiusInput.focus();
          return;
        }
        if (
          shadowIntensityVal === "" ||
          isNaN(shadowIntensityVal) ||
          shadowIntensityVal < 0 ||
          shadowIntensityVal > 100
        ) {
          alert("Intensidade da sombra deve ser um número entre 0 e 100.");
          shadowIntensityInput.focus();
          return;
        }
        const design = {
          font: fontSelect.value,
          borderRadius: borderRadiusVal,
          shadowIntensity: shadowIntensityVal,
        };
        localStorage.setItem(STORAGE_KEYS.design, JSON.stringify(design));
        applyDesign(design);
        alert("Configurações de design aplicadas e salvas!");
      });

      // Apply custom CSS
      applyCustomCssBtn.addEventListener("click", () => {
        const css = customCssTextarea.value;
        localStorage.setItem(STORAGE_KEYS.customCss, css);
        applyCustomCss(css);
        alert("CSS personalizado aplicado e salvo!");
      });

      // Export settings
      exportSettingsBtn.addEventListener("click", () => {
        const data = {
          general: JSON.parse(localStorage.getItem(STORAGE_KEYS.general)) || {},
          colors: JSON.parse(localStorage.getItem(STORAGE_KEYS.colors)) || {},
          buttons: JSON.parse(localStorage.getItem(STORAGE_KEYS.buttons)) || {},
          categories: JSON.parse(localStorage.getItem(STORAGE_KEYS.categories)) || [],
          design: JSON.parse(localStorage.getItem(STORAGE_KEYS.design)) || {},
          customCss: localStorage.getItem(STORAGE_KEYS.customCss) || "",
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "fideprota_admin_settings.json";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });

      // Import settings
      importSettingsInput.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            const data = JSON.parse(event.target.result);
            if (typeof data !== "object") throw new Error("Arquivo inválido");
            if (data.general) {
              localStorage.setItem(STORAGE_KEYS.general, JSON.stringify(data.general));
            }
            if (data.colors) {
              localStorage.setItem(STORAGE_KEYS.colors, JSON.stringify(data.colors));
            }
            if (data.buttons) {
              localStorage.setItem(STORAGE_KEYS.buttons, JSON.stringify(data.buttons));
            }
            if (data.categories) {
              localStorage.setItem(STORAGE_KEYS.categories, JSON.stringify(data.categories));
            }
            if (data.design) {
              localStorage.setItem(STORAGE_KEYS.design, JSON.stringify(data.design));
            }
            if (typeof data.customCss === "string") {
              localStorage.setItem(STORAGE_KEYS.customCss, data.customCss);
            }
            alert("Configurações importadas com sucesso! A página será recarregada.");
            location.reload();
          } catch (err) {
            alert("Erro ao importar configurações: arquivo inválido.");
          }
        };
        reader.readAsText(file);
        e.target.value = "";
      });

      // Apply colors to page preview
      function applyColors(colors) {
        document.documentElement.style.setProperty("--color-primary", colors.primary);
        document.documentElement.style.setProperty("--color-secondary", colors.secondary);
        document.documentElement.style.setProperty("--color-background", colors.background);
        // Update header and footer gradient dynamically
        const header = document.querySelector("header");
        const footer = document.querySelector("footer");
        if (header && footer) {
          header.style.background = `linear-gradient(90deg, ${colors.primary} 0%, ${colors.secondary} 50%, ${colors.primary} 100%)`;
          footer.style.background = `linear-gradient(90deg, ${colors.primary} 0%, ${colors.secondary} 50%, ${colors.primary} 100%)`;
        }
        // Update body background
        document.body.style.backgroundColor = colors.background;
      }

      // Apply design to page preview
      function applyDesign(design) {
        document.body.style.fontFamily = design.font;
        const borderRadiusPx = design.borderRadius + "px";
        document.querySelectorAll(".rounded-3xl").forEach((el) => {
          el.style.borderRadius = borderRadiusPx;
        });
        document.querySelectorAll(".rounded-full").forEach((el) => {
          el.style.borderRadius = borderRadiusPx;
        });
        const intensity = parseInt(design.shadowIntensity, 10);
        const shadowColor = `rgba(124, 58, 237, ${intensity / 100})`; // purple shadow with variable opacity
        document.querySelectorAll(".shadow-lg").forEach((el) => {
          el.style.boxShadow = `0 10px 15px -3px ${shadowColor}, 0 4px 6px -4px ${shadowColor}`;
        });
        document.querySelectorAll(".shadow-2xl").forEach((el) => {
          el.style.boxShadow = `0 25px 50px -12px ${shadowColor}`;
        });
      }

      // Apply custom CSS
      let customStyleTag = null;
      function applyCustomCss(css) {
        if (!customStyleTag) {
          customStyleTag = document.createElement("style");
          customStyleTag.id = "customCssStyleTag";
          document.head.appendChild(customStyleTag);
        }
        customStyleTag.textContent = css;
      }

      // Load saved settings
      function loadSettings() {
        // General
        const general = JSON.parse(localStorage.getItem(STORAGE_KEYS.general));
        if (general) {
          siteTitleInput.value = general.siteTitle || "FideProta";
          siteDescriptionInput.value =
            general.siteDescription ||
            "Melhore o desempenho do seu PC e personalize sua tela com papéis de parede incríveis.";
          instagramHandleInput.value = general.instagramHandle || "fideprotaofc";
          logoUrlInput.value =
            general.logoUrl ||
            "https://storage.googleapis.com/a1aa/image/11fec6f7-8ef5-4317-0086-dbc71223c069.jpg";
          footerLogoUrlInput.value =
            general.footerLogoUrl ||
            "https://storage.googleapis.com/a1aa/image/c4835b56-92df-47a6-3d3c-2c05c867d24c.jpg";
        }

        // Colors
        const colors = JSON.parse(localStorage.getItem(STORAGE_KEYS.colors));
        if (colors) {
          colorPrimaryInput.value = colors.primary;
          colorSecondaryInput.value = colors.secondary;
          colorBackgroundInput.value = colors.background;
          applyColors(colors);
        }

        // Buttons
        const buttons = JSON.parse(localStorage.getItem(STORAGE_KEYS.buttons));
        if (buttons) {
          btnPrimaryText.value = buttons.primaryText;
          btnPrimaryLink.value = buttons.primaryLink;
          btnSecondaryText.value = buttons.secondaryText;
          btnSecondaryLink.value = buttons.secondaryLink;
        }

        // Categories
        renderCategories();

        // Design
        const design = JSON.parse(localStorage.getItem(STORAGE_KEYS.design));
        if (design) {
          fontSelect.value = design.font;
          borderRadiusInput.value = design.borderRadius;
          shadowIntensityInput.value = design.shadowIntensity;
          applyDesign(design);
        }

        // Custom CSS
        const css = localStorage.getItem(STORAGE_KEYS.customCss);
        if (css) {
          customCssTextarea.value = css;
          applyCustomCss(css);
        }
      }

      // Initialize
      checkLogin();
    })();
  </script>
</body>
</html>
